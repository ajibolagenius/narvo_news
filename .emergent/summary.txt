<analysis>**original_problem_statement:** The user wants to build a full-stack, monorepo application called Narvo. Narvo is a precision-engineered, audio-first news broadcast platform designed for global audiences, with a primary focus on African markets.

**PRODUCT REQUIREMENTS:**
- **Mission:** Democratize access to high-quality, trustworthy news through an audio-first broadcast experience.
- **Core Pillars:** Minimalism, Broadcast-Grade Audio, Trusted Authority, Engineering Excellence.
- **Tech Stack:** React, FastAPI, MongoDB, Supabase (Auth), Gemini & OpenAI TTS (via Emergent LLM Key).
- **UI/UX:** Follow a strict design system, with recent updates introducing a light mode, new iconography (Phosphor), and motion libraries. The application is expected to be highly performant and responsive.

**User's preferred language**: English

**what currently exists?**
The application is a full-featured news platform with a functional dashboard, discover page, offline page, and settings. The UI has been updated with a new light mode theme based on the user's design system document.

Key features implemented in the last session include:
- Fully functional Discover and Offline pages integrated with the backend.
- A Save for Offline feature for news articles and podcasts.
- A comprehensive podcast audio caching system that downloads audio files as blobs to IndexedDB, bypassing CORS issues with a backend proxy.
- Offline playback of cached audio files directly from the Offline page.
- A service worker has been added for basic PWA functionality, including background sync and push notification handlers.
- A Download All button on the Discover page for batch-caching podcasts.
- A notification settings section on the System Settings page.
- A critical application-wide scrolling bug has been fixed by refactoring the layout of nearly all pages to resolve nested scroll conflicts.

**Last working item**:
    - Last item agent was working: The user approved the agent's suggestion to implement a global download queue indicator that shows download progress across pages. The agent has created the initial files for the context and component but has not yet integrated them into the application.
    - Status: IN PROGRESS
    - Agent Testing Done: N
    - Which testing method agent to use? both
    - User Testing Done: N

**All Pending/In progress Issue list**:
No pending issues.

**In progress Task List**:
  - Task 1:  (P0) Implement Global Download Queue Indicator

 Task Detail:
  - Task 1: 
     - Where to resume: The agent has created  and . The next steps are:
        1.  Wrap the application with  in .
        2.  Render the  component in  so it's visible globally.
        3.  Refactor the  and  functions in  to use the  for reporting progress.
     - What will be achieved with this? A floating UI element will appear and show the real-time progress of batch podcast downloads, and it will remain visible even when the user navigates to other pages.
     - Status:  IN PROGRESS
     - Should Test frontend/backend/both after fix? frontend
     - Blocked on something: No

**Upcoming and Future Tasks**
**Upcoming Tasks:**
- **P1:** Integrate the real Dubawa fact-checking API to replace the current mock implementation.

**Future Tasks:**
- **P2:** Implement the native mobile application based on the provided performance guidelines.

**Completed work in this session**
- **Critical Bug Fix: Application-Wide Scrolling:**
  - Resolved a major bug where mouse-wheel scrolling did not work on the Dashboard, Discover, and other pages.
  - **Fix:** Systematically removed nested scroll containers by refactoring  and ensuring all pages within it manage their own scrolling using a  pattern. This involved fixing over a dozen page components.
  - **Fix:** Corrected layout issues in  and  by replacing root-level React Fragments () with a proper  wrapper to make them single children within their flex container.

- **Feature Implementation & Integration:**
  - **Light Mode Update:** Updated CSS variables in  to match the new light mode colors from the user's design system document.
  - **Discover & Offline Pages:** Connected the frontend pages to the backend APIs, replacing hardcoded data with live data for podcasts and trending topics.
  - **Podcast Caching & Offline Playback (P1):**
    - Implemented end-to-end functionality to download podcast audio files and store them as blobs in IndexedDB.
    - Created a backend proxy endpoint () to bypass CORS errors from external audio sources.
    - Enabled playback of cached audio directly from the Offline page.
  - **PWA & Future Features (P2/P3):**
    - **Service Worker:** Created and registered a service worker () to handle background sync and push notifications.
    - **Download All:** Added a Download All button to the Discover page for batch downloading podcasts.
    - **Push Notifications:** Implemented a UI toggle in System Settings and a service worker handler for push notifications.

- **Backend Modularization:**
  - Began refactoring the monolithic  by creating dedicated route files (, , , ) and including them as s in the main FastAPI app.

- **Bug Fixes & Refinements:**
  - **Offline Page Crash:** Fixed a  crash on the Offline page by correctly using the  function from the .
  - **Breaking News Banner:** Corrected the text color of the breaking news banner in light mode to be white for better readability.
  - **Discover Page UI:** Replaced the generic hero image on the Discover page with a more fitting image of a broadcast studio.

**Earlier issues found/mentioned but not fixed**
None.

**Known issue recurrence from previous fork**
N/A

**Code Architecture**


**Key Technical Concepts**
- **Flexbox Layout for Scrolling:** The key to fixing the scroll issue was enforcing a strict parent-child flex layout. The main layout wrapper provides a flexible container (), and each page's primary content  uses  to handle its own scrolling. The  on the parent is critical to prevent the child from expanding infinitely.
- **IndexedDB for Blob Storage:** The application now stores large binary audio files directly in the browser's IndexedDB. This was achieved by fetching the audio, converting the response to a , and storing it in an object store.
- **Backend Proxy for CORS:** A new API endpoint () was created to act as a proxy. The frontend calls this endpoint, which then fetches the audio from the external URL on the server-side and streams it back to the client, effectively bypassing browser CORS restrictions.
- **Service Workers (PWA):** A service worker () has been registered to manage PWA features. It currently includes handlers for background sync ( event) and push notifications ( event).

**key DB schema**
- ****: 
- ****: 

**changes in tech stack**
- No new package dependencies were added.
- The application now leverages browser-native technologies: **Service Workers** and **IndexedDB** for advanced offline capabilities.

**All files of reference**
- **New Files Created:**
  - 
  - 
  - 
  - 
  - 
  - 
  - 
- **Key Files Updated:**
  - **Scrolling Fix:** Almost every file in  was modified to ensure correct flexbox and overflow properties. Key among them are , , and .  was also central to the fix.
  - **Audio Caching:**  (complete overhaul),  (to play from cache),  (to trigger downloads).
  - **Backend:**  (to include new routers),  (to add audio proxy).
  - **Theming:**  (for new light mode colors).
  - **PWA:**  (to register service worker).

**Areas that need refactoring**:
- **Backend Services:** The backend modularization has started by moving endpoints to , but the business logic still largely resides within the route functions in  or the new route files. This logic should be extracted into dedicated service files under  to improve separation of concerns.

**key api endpoints**
- : Fetches list of podcasts.
- : **(New)** Proxies audio file download to bypass CORS.
- : Fetches saved articles metadata.

**Critical Info for New Agent**
- **The Scrolling Fix is Fragile:** The application-wide scrolling now works correctly, but it relies on a consistent layout pattern ( on parents,  on children). When adding or modifying pages, you MUST adhere to this pattern to avoid reintroducing the scroll bug. Do not add  properties to .
- **Immediate Task:** Your priority is to complete the global download queue indicator. The groundwork is laid; you just need to integrate the new context and component.
- **Offline Audio Flow:** Remember that podcast downloads and playback are a multi-step process: Frontend -> Backend Proxy -> External URL -> IndexedDB Blob -> Audio Player.

**documents and test reports created in this job**
- 
- 
-  (updated)

**Last 10 User Messages and any pending HUMAN messages** 
1. **User:** Reports that the dashboard is broken and the breaking news banner text color is wrong in light mode.
2. **Agent:** Investigates, confirms the banner color issue, and fixes it. Identifies the broken dashboard is actually a page scrolling issue.
3. **Agent:** Fixes the scroll issue in .
4. **Agent:** Realizes the fix isn't enough and the page still doesn't scroll with the mouse wheel. Diagnoses a nested scroll conflict.
5. **User:** FIX: The mouse still does not scroll the dashboard or discover pages. You should also check other app pages to see if they have the same issue.
6. **Agent:** Systematically refactors all pages to remove nested scrolling and fix flexbox layout issues, which finally resolves the scrolling bug.
7. **User:** Provides P1/P2 tasks (Podcast caching, offline playback, PWA service worker).
8. **Agent:** Implements all P1 and P2 tasks, including the backend CORS proxy. Reports a bug in  ( error) and fixes it.
9. **User:** Provides P3 tasks (background sync, push notifications, download all).
10. **Agent:** Implements all P3 tasks. Suggests a global download queue indicator for a better UX, and the user approves with **Yes**. Agent begins implementation.

**Project Health Check:**
- **Broken:** None.
- **Mocked:** The Dubawa fact-checking integration remains a mock API.
- **Untested:** The new global download queue indicator.

**3rd Party Integrations**
- **@phosphor-icons/react:** The standard icon library.
- **framer-motion, gsap:** UI animation libraries.
- **Supabase:** User authentication.
- **MongoDB:** Data persistence.
- **Google Gemini & OpenAI TTS:** Used via Emergent LLM Key for content/audio generation.

**Testing status**
  - Testing agent used after significant changes: YES. The agent confirmed the backend modularization and scrolling fixes were successful.
  - Troubleshoot agent used after agent stuck in loop: NO
  - Test files created: None
  - Known regressions: None.

**Credentials to test flow:**
Use the Guest Mode accessible from the landing page (Oya, Play button) for testing all UI features.

**What agent forgot to execute**
The agent is correctly following the user-approved plan and is in the middle of implementing the global download queue indicator. Nothing has been forgotten.</analysis>
