"use strict";(self.webpackChunknarvo_frontend=self.webpackChunknarvo_frontend||[]).push([[23],{7302(e,s,a){a.d(s,{Ay:()=>x,Oi:()=>l,_N:()=>i,c$:()=>c,if:()=>n});a(5043);var t=a(579);const r=e=>{let{className:s="",variant:a="rect"}=e;const r="animate-pulse bg-forest/10";return"circle"===a?(0,t.jsx)("div",{className:"".concat(r," rounded-full ").concat(s)}):"text"===a?(0,t.jsx)("div",{className:"".concat(r," h-4 ").concat(s)}):(0,t.jsx)("div",{className:"".concat(r," ").concat(s)})},c=()=>(0,t.jsxs)("div",{className:"narvo-border bg-surface/30 flex flex-col md:flex-row min-h-[320px]",children:[(0,t.jsx)("div",{className:"md:w-1/2 bg-forest/5 min-h-[200px]"}),(0,t.jsxs)("div",{className:"flex-1 p-8 flex flex-col justify-between gap-4",children:[(0,t.jsxs)("div",{className:"space-y-4",children:[(0,t.jsx)(r,{variant:"text",className:"w-40 h-3"}),(0,t.jsx)(r,{variant:"text",className:"w-full h-8"}),(0,t.jsx)(r,{variant:"text",className:"w-3/4 h-8"}),(0,t.jsx)(r,{variant:"text",className:"w-full h-4 mt-4"}),(0,t.jsx)(r,{variant:"text",className:"w-2/3 h-4"})]}),(0,t.jsxs)("div",{className:"flex gap-4",children:[(0,t.jsx)(r,{className:"flex-1 h-12"}),(0,t.jsx)(r,{className:"w-12 h-12"}),(0,t.jsx)(r,{className:"w-12 h-12"})]})]})]}),l=()=>(0,t.jsxs)("div",{className:"p-6 narvo-border-b",children:[(0,t.jsxs)("div",{className:"flex justify-between mb-3",children:[(0,t.jsxs)("div",{className:"flex gap-3",children:[(0,t.jsx)(r,{variant:"text",className:"w-24 h-4"}),(0,t.jsx)(r,{variant:"text",className:"w-14 h-4"})]}),(0,t.jsx)(r,{variant:"text",className:"w-20 h-4"})]}),(0,t.jsx)(r,{variant:"text",className:"w-full h-6 mb-2"}),(0,t.jsx)(r,{variant:"text",className:"w-3/4 h-6 mb-3"}),(0,t.jsx)(r,{variant:"text",className:"w-full h-4"}),(0,t.jsx)(r,{variant:"text",className:"w-2/3 h-4 mt-1"})]}),n=()=>(0,t.jsxs)("div",{className:"space-y-6",children:[(0,t.jsxs)("div",{className:"flex gap-2",children:[(0,t.jsx)(r,{className:"w-20 h-6"}),(0,t.jsx)(r,{className:"w-20 h-6"})]}),(0,t.jsx)(r,{variant:"text",className:"w-full h-12"}),(0,t.jsx)(r,{variant:"text",className:"w-4/5 h-12"}),(0,t.jsxs)("div",{className:"border-l-2 border-forest/20 pl-6 space-y-2",children:[(0,t.jsx)(r,{variant:"text",className:"w-full h-5"}),(0,t.jsx)(r,{variant:"text",className:"w-3/4 h-5"})]}),(0,t.jsx)(r,{className:"w-full h-[400px]"}),(0,t.jsx)(r,{className:"w-full h-16"}),(0,t.jsxs)("div",{className:"space-y-3",children:[(0,t.jsx)(r,{variant:"text",className:"w-full h-4"}),(0,t.jsx)(r,{variant:"text",className:"w-full h-4"}),(0,t.jsx)(r,{variant:"text",className:"w-2/3 h-4"})]})]}),i=e=>{let{count:s=4}=e;return(0,t.jsx)("div",{className:"narvo-border bg-surface/20 divide-y divide-forest/10",children:Array.from({length:s}).map((e,s)=>(0,t.jsx)(l,{},s))})},x=r},9023(e,s,a){a.r(s),a.d(s,{default:()=>d});var t=a(5043),r=a(3494),c=a(1739),l=a(6788),n=a(4395),i=a(3988),x=a(7302),o=a(579);const d=()=>{const[e,s]=(0,t.useState)([]),[a,d]=(0,t.useState)(!0),{user:m}=(0,n.A)(),{playTrack:h}=(0,i.n)();(0,t.useEffect)(()=>{const e=(null===m||void 0===m?void 0:m.id)||"guest";fetch("".concat("http://localhost:8000","/api/listening-history/").concat(e,"?limit=30")).then(e=>e.json()).then(e=>{s(e),d(!1)}).catch(()=>d(!1))},[null===m||void 0===m?void 0:m.id]);const p=e=>{if(!e)return"";const s=new Date(e),a=(new Date-s)/1e3;return a<60?"JUST_NOW":a<3600?"".concat(Math.floor(a/60),"M_AGO"):a<86400?"".concat(Math.floor(a/3600),"H_AGO"):a<604800?"".concat(Math.floor(a/86400),"D_AGO"):s.toLocaleDateString("en-GB",{day:"2-digit",month:"short"})},j=(e=>{const s={};return e.forEach(e=>{const a=new Date(e.played_at).toLocaleDateString("en-GB",{weekday:"long",day:"numeric",month:"long"});s[a]||(s[a]=[]),s[a].push(e)}),s})(e);return(0,o.jsx)("main",{className:"flex-1 overflow-y-auto overflow-x-hidden custom-scroll bg-background-dark min-h-0","data-testid":"listening-history-page",children:(0,o.jsxs)("div",{className:"p-4 md:p-8 lg:p-10 pb-32 md:pb-10",children:[(0,o.jsxs)("div",{className:"flex items-end justify-between mb-6 md:mb-8 narvo-border-b pb-4",children:[(0,o.jsxs)("div",{children:[(0,o.jsx)("h1",{className:"font-display text-2xl md:text-3xl font-bold text-content uppercase tracking-tight",children:"LISTENING_HISTORY"}),(0,o.jsx)("p",{className:"mono-ui text-[10px] md:text-[11px] text-forest font-bold mt-1",children:"RECENTLY_PLAYED_BROADCASTS // TIMELINE"})]}),(0,o.jsxs)("div",{className:"flex items-center gap-2",children:[(0,o.jsx)(r.z,{className:"w-4 h-4 text-forest"}),(0,o.jsxs)("span",{className:"mono-ui text-[10px] text-forest",children:[e.length,"_ENTRIES"]})]})]}),a?(0,o.jsx)("div",{className:"space-y-4",children:Array.from({length:5}).map((e,s)=>(0,o.jsxs)("div",{className:"narvo-border p-4 flex items-center gap-4",children:[(0,o.jsx)(x.Ay,{variant:"text",className:"w-10 h-10"}),(0,o.jsxs)("div",{className:"flex-1",children:[(0,o.jsx)(x.Ay,{variant:"text",className:"w-48 h-4 mb-2"}),(0,o.jsx)(x.Ay,{variant:"text",className:"w-32 h-3"})]})]},s))}):0===e.length?(0,o.jsxs)("div",{className:"narvo-border bg-surface/10 p-8 md:p-12 text-center",children:[(0,o.jsx)(l.C,{className:"w-12 h-12 text-forest/30 mx-auto mb-4"}),(0,o.jsx)("h3",{className:"font-display text-lg font-bold text-content uppercase mb-2",children:"NO_HISTORY_YET"}),(0,o.jsx)("p",{className:"mono-ui text-[11px] text-forest",children:"Play a broadcast to see it appear here."})]}):(0,o.jsx)("div",{className:"space-y-6 md:space-y-8",children:Object.entries(j).map(e=>{let[s,a]=e;return(0,o.jsxs)("div",{children:[(0,o.jsxs)("div",{className:"flex items-center gap-3 mb-3 md:mb-4",children:[(0,o.jsx)("div",{className:"w-2 h-2 bg-primary"}),(0,o.jsx)("span",{className:"mono-ui text-[11px] md:text-[12px] text-forest font-bold tracking-widest",children:s.toUpperCase()}),(0,o.jsx)("div",{className:"flex-1 h-px bg-forest/20"})]}),(0,o.jsx)("div",{className:"space-y-2",children:a.map((e,s)=>(0,o.jsxs)("div",{className:"narvo-border p-3 md:p-4 flex items-center gap-3 md:gap-4 hover:bg-surface/20 hover:border-forest transition-colors group cursor-pointer",onClick:()=>{e.track_id&&h({id:e.track_id,title:e.title,source:e.source})},"data-testid":"history-item-".concat(s),children:[(0,o.jsx)("div",{className:"w-9 h-9 md:w-10 md:h-10 narvo-border flex items-center justify-center shrink-0 group-hover:bg-primary group-hover:border-primary transition-colors",children:(0,o.jsx)(c.j,{className:"w-4 h-4 text-forest group-hover:text-background-dark",fill:"currentColor"})}),(0,o.jsxs)("div",{className:"flex-1 min-w-0",children:[(0,o.jsx)("h4",{className:"text-content text-xs md:text-sm font-display font-bold truncate group-hover:text-primary transition-colors",children:e.title}),(0,o.jsxs)("div",{className:"flex items-center gap-2 mt-0.5",children:[e.source&&(0,o.jsx)("span",{className:"mono-ui text-[9px] md:text-[10px] text-forest font-bold truncate",children:e.source}),e.category&&(0,o.jsxs)(o.Fragment,{children:[(0,o.jsx)("span",{className:"text-forest/30",children:"/"}),(0,o.jsx)("span",{className:"mono-ui text-[9px] md:text-[10px] text-primary",children:e.category.toUpperCase()})]})]})]}),(0,o.jsx)("span",{className:"mono-ui text-[9px] md:text-[10px] text-forest/50 shrink-0",children:p(e.played_at)})]},"".concat(e.track_id,"-").concat(s)))})]},s)})})]})})}}}]);
//# sourceMappingURL=23.d462629b.chunk.js.map