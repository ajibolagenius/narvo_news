{"version":3,"file":"static/js/23.d462629b.chunk.js","mappings":"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","sources":["components/Skeleton.js","pages/ListeningHistoryPage.js"],"sourcesContent":["import React from 'react';\n\nconst Skeleton = ({ className = '', variant = 'rect' }) => {\n  const base = 'animate-pulse bg-forest/10';\n  if (variant === 'circle') return <div className={`${base} rounded-full ${className}`} />;\n  if (variant === 'text') return <div className={`${base} h-4 ${className}`} />;\n  return <div className={`${base} ${className}`} />;\n};\n\nexport const FeaturedSkeleton = () => (\n  <div className=\"narvo-border bg-surface/30 flex flex-col md:flex-row min-h-[320px]\">\n    <div className=\"md:w-1/2 bg-forest/5 min-h-[200px]\" />\n    <div className=\"flex-1 p-8 flex flex-col justify-between gap-4\">\n      <div className=\"space-y-4\">\n        <Skeleton variant=\"text\" className=\"w-40 h-3\" />\n        <Skeleton variant=\"text\" className=\"w-full h-8\" />\n        <Skeleton variant=\"text\" className=\"w-3/4 h-8\" />\n        <Skeleton variant=\"text\" className=\"w-full h-4 mt-4\" />\n        <Skeleton variant=\"text\" className=\"w-2/3 h-4\" />\n      </div>\n      <div className=\"flex gap-4\">\n        <Skeleton className=\"flex-1 h-12\" />\n        <Skeleton className=\"w-12 h-12\" />\n        <Skeleton className=\"w-12 h-12\" />\n      </div>\n    </div>\n  </div>\n);\n\nexport const StreamCardSkeleton = () => (\n  <div className=\"p-6 narvo-border-b\">\n    <div className=\"flex justify-between mb-3\">\n      <div className=\"flex gap-3\"><Skeleton variant=\"text\" className=\"w-24 h-4\" /><Skeleton variant=\"text\" className=\"w-14 h-4\" /></div>\n      <Skeleton variant=\"text\" className=\"w-20 h-4\" />\n    </div>\n    <Skeleton variant=\"text\" className=\"w-full h-6 mb-2\" />\n    <Skeleton variant=\"text\" className=\"w-3/4 h-6 mb-3\" />\n    <Skeleton variant=\"text\" className=\"w-full h-4\" />\n    <Skeleton variant=\"text\" className=\"w-2/3 h-4 mt-1\" />\n  </div>\n);\n\nexport const ArticleSkeleton = () => (\n  <div className=\"space-y-6\">\n    <div className=\"flex gap-2\"><Skeleton className=\"w-20 h-6\" /><Skeleton className=\"w-20 h-6\" /></div>\n    <Skeleton variant=\"text\" className=\"w-full h-12\" />\n    <Skeleton variant=\"text\" className=\"w-4/5 h-12\" />\n    <div className=\"border-l-2 border-forest/20 pl-6 space-y-2\">\n      <Skeleton variant=\"text\" className=\"w-full h-5\" />\n      <Skeleton variant=\"text\" className=\"w-3/4 h-5\" />\n    </div>\n    <Skeleton className=\"w-full h-[400px]\" />\n    <Skeleton className=\"w-full h-16\" />\n    <div className=\"space-y-3\">\n      <Skeleton variant=\"text\" className=\"w-full h-4\" />\n      <Skeleton variant=\"text\" className=\"w-full h-4\" />\n      <Skeleton variant=\"text\" className=\"w-2/3 h-4\" />\n    </div>\n  </div>\n);\n\nexport const ListSkeleton = ({ count = 4 }) => (\n  <div className=\"narvo-border bg-surface/20 divide-y divide-forest/10\">\n    {Array.from({ length: count }).map((_, i) => <StreamCardSkeleton key={i} />)}\n  </div>\n);\n\nexport default Skeleton;\n","import React, { useState, useEffect } from 'react';\nimport { Clock, Play, Waveform } from '@phosphor-icons/react';\nimport { useAuth } from '../contexts/AuthContext';\nimport { useAudio } from '../contexts/AudioContext';\nimport Skeleton from '../components/Skeleton';\n\nconst API_URL = process.env.REACT_APP_BACKEND_URL || '';\n\nconst ListeningHistoryPage = () => {\n  const [history, setHistory] = useState([]);\n  const [loading, setLoading] = useState(true);\n  const { user } = useAuth();\n  const { playTrack } = useAudio();\n\n  useEffect(() => {\n    const userId = user?.id || 'guest';\n    fetch(`${API_URL}/api/listening-history/${userId}?limit=30`)\n      .then(r => r.json())\n      .then(data => { setHistory(data); setLoading(false); })\n      .catch(() => setLoading(false));\n  }, [user?.id]);\n\n  const formatTime = (isoStr) => {\n    if (!isoStr) return '';\n    const d = new Date(isoStr);\n    const now = new Date();\n    const diff = (now - d) / 1000;\n    if (diff < 60) return 'JUST_NOW';\n    if (diff < 3600) return `${Math.floor(diff / 60)}M_AGO`;\n    if (diff < 86400) return `${Math.floor(diff / 3600)}H_AGO`;\n    if (diff < 604800) return `${Math.floor(diff / 86400)}D_AGO`;\n    return d.toLocaleDateString('en-GB', { day: '2-digit', month: 'short' });\n  };\n\n  const groupByDate = (items) => {\n    const groups = {};\n    items.forEach(item => {\n      const d = new Date(item.played_at);\n      const key = d.toLocaleDateString('en-GB', { weekday: 'long', day: 'numeric', month: 'long' });\n      if (!groups[key]) groups[key] = [];\n      groups[key].push(item);\n    });\n    return groups;\n  };\n\n  const grouped = groupByDate(history);\n\n  return (\n    <main className=\"flex-1 overflow-y-auto overflow-x-hidden custom-scroll bg-background-dark min-h-0\" data-testid=\"listening-history-page\">\n      <div className=\"p-4 md:p-8 lg:p-10 pb-32 md:pb-10\">\n        {/* Header */}\n        <div className=\"flex items-end justify-between mb-6 md:mb-8 narvo-border-b pb-4\">\n          <div>\n            <h1 className=\"font-display text-2xl md:text-3xl font-bold text-content uppercase tracking-tight\">\n              LISTENING_HISTORY\n            </h1>\n            <p className=\"mono-ui text-[10px] md:text-[11px] text-forest font-bold mt-1\">\n              RECENTLY_PLAYED_BROADCASTS // TIMELINE\n            </p>\n          </div>\n          <div className=\"flex items-center gap-2\">\n            <Clock className=\"w-4 h-4 text-forest\" />\n            <span className=\"mono-ui text-[10px] text-forest\">{history.length}_ENTRIES</span>\n          </div>\n        </div>\n\n        {loading ? (\n          <div className=\"space-y-4\">\n            {Array.from({ length: 5 }).map((_, i) => (\n              <div key={i} className=\"narvo-border p-4 flex items-center gap-4\">\n                <Skeleton variant=\"text\" className=\"w-10 h-10\" />\n                <div className=\"flex-1\">\n                  <Skeleton variant=\"text\" className=\"w-48 h-4 mb-2\" />\n                  <Skeleton variant=\"text\" className=\"w-32 h-3\" />\n                </div>\n              </div>\n            ))}\n          </div>\n        ) : history.length === 0 ? (\n          <div className=\"narvo-border bg-surface/10 p-8 md:p-12 text-center\">\n            <Waveform className=\"w-12 h-12 text-forest/30 mx-auto mb-4\" />\n            <h3 className=\"font-display text-lg font-bold text-content uppercase mb-2\">NO_HISTORY_YET</h3>\n            <p className=\"mono-ui text-[11px] text-forest\">Play a broadcast to see it appear here.</p>\n          </div>\n        ) : (\n          <div className=\"space-y-6 md:space-y-8\">\n            {Object.entries(grouped).map(([dateLabel, items]) => (\n              <div key={dateLabel}>\n                <div className=\"flex items-center gap-3 mb-3 md:mb-4\">\n                  <div className=\"w-2 h-2 bg-primary\" />\n                  <span className=\"mono-ui text-[11px] md:text-[12px] text-forest font-bold tracking-widest\">\n                    {dateLabel.toUpperCase()}\n                  </span>\n                  <div className=\"flex-1 h-px bg-forest/20\" />\n                </div>\n\n                <div className=\"space-y-2\">\n                  {items.map((item, idx) => (\n                    <div\n                      key={`${item.track_id}-${idx}`}\n                      className=\"narvo-border p-3 md:p-4 flex items-center gap-3 md:gap-4 hover:bg-surface/20 hover:border-forest transition-colors group cursor-pointer\"\n                      onClick={() => {\n                        if (item.track_id) {\n                          playTrack({ id: item.track_id, title: item.title, source: item.source });\n                        }\n                      }}\n                      data-testid={`history-item-${idx}`}\n                    >\n                      {/* Play icon */}\n                      <div className=\"w-9 h-9 md:w-10 md:h-10 narvo-border flex items-center justify-center shrink-0 group-hover:bg-primary group-hover:border-primary transition-colors\">\n                        <Play className=\"w-4 h-4 text-forest group-hover:text-background-dark\" fill=\"currentColor\" />\n                      </div>\n\n                      {/* Track Info */}\n                      <div className=\"flex-1 min-w-0\">\n                        <h4 className=\"text-content text-xs md:text-sm font-display font-bold truncate group-hover:text-primary transition-colors\">\n                          {item.title}\n                        </h4>\n                        <div className=\"flex items-center gap-2 mt-0.5\">\n                          {item.source && (\n                            <span className=\"mono-ui text-[9px] md:text-[10px] text-forest font-bold truncate\">{item.source}</span>\n                          )}\n                          {item.category && (\n                            <>\n                              <span className=\"text-forest/30\">/</span>\n                              <span className=\"mono-ui text-[9px] md:text-[10px] text-primary\">{item.category.toUpperCase()}</span>\n                            </>\n                          )}\n                        </div>\n                      </div>\n\n                      {/* Timestamp */}\n                      <span className=\"mono-ui text-[9px] md:text-[10px] text-forest/50 shrink-0\">\n                        {formatTime(item.played_at)}\n                      </span>\n                    </div>\n                  ))}\n                </div>\n              </div>\n            ))}\n          </div>\n        )}\n      </div>\n    </main>\n  );\n};\n\nexport default ListeningHistoryPage;\n"],"names":["Skeleton","_ref","className","variant","base","_jsx","concat","FeaturedSkeleton","_jsxs","children","StreamCardSkeleton","ArticleSkeleton","ListSkeleton","_ref2","count","Array","from","length","map","_","i","ListeningHistoryPage","history","setHistory","useState","loading","setLoading","user","useAuth","playTrack","useAudio","useEffect","userId","id","fetch","process","then","r","json","data","catch","formatTime","isoStr","d","Date","diff","Math","floor","toLocaleDateString","day","month","grouped","items","groups","forEach","item","key","played_at","weekday","push","groupByDate","Clock","Waveform","Object","entries","dateLabel","toUpperCase","idx","onClick","track_id","title","source","Play","fill","category","_Fragment"],"sourceRoot":""}